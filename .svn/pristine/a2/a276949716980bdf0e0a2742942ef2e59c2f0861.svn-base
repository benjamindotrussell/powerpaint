/**
 * 
 */
package gui;

import java.awt.BasicStroke;
import java.awt.Color;
import java.awt.Dimension;
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.Image;
import java.awt.List;
import java.awt.RenderingHints;
import java.awt.event.MouseAdapter;
import java.awt.event.MouseEvent;
import java.awt.event.MouseMotionAdapter;
import java.awt.geom.GeneralPath;
import java.awt.geom.Path2D;
import java.util.ArrayList;

import gui.Art;
import javax.swing.JPanel;

//import listenter.MyMouseListener;



/**
 * class that implements the JPanel.
 * 
 * @author Ben Russell
 * @version 11/5/2015
 */
public class PaintPanel extends JPanel {
    /** A generated serialization ID. */
    private static final long serialVersionUID = 810958738395164242L;    
    /** A size for the JPanel. */
    private static final Dimension PANEL_SIZE = new Dimension(400, 200);
    /** The current items on the panel. */
    private final ArrayList<Art> myFinishedArt;
    /** The line width. */
    private static final int LINE_WIDTH = 1;
    /** The path being created. */
    private final Path2D myPath;
    Image image;
    private Graphics graphics2D;
    private int myCurrentX;
    private int myCurrentY;
    private int myOldX;
    private int myOldY;
    /**
     * Constructor for the panel.
     */
    public PaintPanel() {
        super();
        setPreferredSize(PANEL_SIZE);
        setBackground(Color.WHITE);
        myPath = new GeneralPath();
        myPath.setWindingRule(GeneralPath.WIND_EVEN_ODD);
        myFinishedArt = new ArrayList<Art>();
        
        addMouseListener(new MouseAdapter() {
            public void mousePressed(final MouseEvent theEvent) {
                myOldX = theEvent.getX();
                myOldY = theEvent.getY();
            }            
        });
        addMouseListener(new MouseAdapter() {
            public void mouseReleased(final MouseEvent theEvent) {
                myCurrentX = theEvent.getX();
                myCurrentY = theEvent.getY();
                graphics2D.drawLine(myOldX, myOldY, myCurrentX, myCurrentY);
                
                repaint();
                
                myOldX = myCurrentX;
                myOldY = myCurrentY;
            }
        });
        
        addMouseMotionListener(new MouseMotionAdapter() { 
            public void mouseDragged(final MouseEvent theEvent) {
                clear();
                myCurrentX = theEvent.getX();
                myCurrentY = theEvent.getY();
                if (graphics2D != null) {
                    graphics2D.drawLine(myOldX, myOldY, myCurrentX, myCurrentY);
                }
                
                
                repaint();
               
                
                
            }
        });
        
        
    }
    
    @Override
    protected void paintComponent(final Graphics theGraphics) {
        super.paintComponent(theGraphics);
        if (image == null) {
            image = createImage(getSize().width, getSize().height);
            graphics2D = (Graphics2D)image.getGraphics();
            ((Graphics2D) graphics2D).setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);
            clear();
        }
        final Graphics2D graphics = (Graphics2D) theGraphics;
        
        graphics.setRenderingHint(RenderingHints.KEY_ANTIALIASING,
                             RenderingHints.VALUE_ANTIALIAS_ON);
        graphics.setPaint(Color.RED);
        graphics.setStroke(new BasicStroke(LINE_WIDTH));
        graphics.draw(myPath);
        theGraphics.drawImage(image, 0, 0, null);
    }
    public void clear(){
        ((Graphics2D) graphics2D).setPaint(Color.white);
        graphics2D.fillRect(0, 0, getSize().width, getSize().height);
        ((Graphics2D) graphics2D).setPaint(Color.black);
        repaint();
    }
    /**
     * Listens for mouse clicks, to draw on our panel.
     */
    private class MyMouseListener extends MouseAdapter {
        /**
         * Handles a click event.
         * 
         * @param theEvent The event.
         */
        @Override
        public void mousePressed(final MouseEvent theEvent) {
            
//            if (myPath.getCurrentPoint() == null) {
//                myPath.moveTo(theEvent.getX(), theEvent.getY());
//            } else if (theEvent.getClickCount() == 2) {
//                myPath.closePath();
//            } else {
//                myPath.lineTo(theEvent.getX(), theEvent.getY());
//            }
            if (myPath.getCurrentPoint() == null) {
                myPath.moveTo(theEvent.getX(), theEvent.getY());
            } else {
                myPath.lineTo(theEvent.getX(), theEvent.getY());
            }
            repaint();
        }
//        @Override 
//        public void mouseDragged(final MouseEvent theEvent) {
//            if (myPath.getCurrentPoint() == null) {
//                myPath.moveTo(theEvent.getX(), theEvent.getY());
//            } else {
//                myPath.lineTo(theEvent.getX(), theEvent.getY());
//            }
//            repaint();
//        }
        @Override 
        public void mouseReleased(final MouseEvent theEvent) {
            
        }
    }
//    /**
//     * Removes all of the drawings on the panel.
//     */
//    public void clearPanel()
//    {
//      myFinishedDrawings.clear();
//      myHasCurrent = false;
//      repaint();
//    }
}
